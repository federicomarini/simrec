<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>simrec — simrec • simrec</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="simrec — simrec"><meta property="og:description" content="This function allows simulation of recurrent event data following the multiplicative
intensity model described in Andersen and Gill [1] with the baseline hazard being a
function of the total/calendar time. To induce between-subject-heterogeneity a random
effect covariate (frailty term) can be incorporated. Data for individual \(i\) are generated
according to the intensity process $$Y_i(t) * \lambda_0(t)* Z_i *exp(\beta^t X_i),$$
where \(X_i\) defines the covariate vector and \(\beta\) the regression coefficient vector.
\(\lambda_0(t)\) denotes the baseline hazard, being a function of the total/calendar
time \(t\), and \(Y_i(t)\) the predictable process
that equals one as long as individual \(i\) is under observation and at risk for experiencing events.
\(Z_i\) denotes the frailty variable with \((Z_i)_i\) iid with \(E(Z_i)=1\) and
\(Var(Z_i)=\theta\). The parameter \(\theta\) describes the degree of
between-subject-heterogeneity. Data output is in the counting process format."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simrec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/simrec-vignette.html">simrec: An R-Package for Simulation of Recurrent Event Data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/federicomarini/simrec/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>simrec</h1>
    <small class="dont-index">Source: <a href="https://github.com/federicomarini/simrec/blob/HEAD/R/simrec.R" class="external-link"><code>R/simrec.R</code></a></small>
    <div class="hidden name"><code>simrec.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows simulation of recurrent event data following the multiplicative
intensity model described in Andersen and Gill [1] with the baseline hazard being a
function of the total/calendar time. To induce between-subject-heterogeneity a random
effect covariate (frailty term) can be incorporated. Data for individual \(i\) are generated
according to the intensity process $$Y_i(t) * \lambda_0(t)* Z_i *exp(\beta^t X_i),$$
where \(X_i\) defines the covariate vector and \(\beta\) the regression coefficient vector.
\(\lambda_0(t)\) denotes the baseline hazard, being a function of the total/calendar
time \(t\), and \(Y_i(t)\) the predictable process
that equals one as long as individual \(i\) is under observation and at risk for experiencing events.
\(Z_i\) denotes the frailty variable with \((Z_i)_i\) iid with \(E(Z_i)=1\) and
\(Var(Z_i)=\theta\). The parameter \(\theta\) describes the degree of
between-subject-heterogeneity. Data output is in the counting process format.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simrec</span><span class="op">(</span></span>
<span>  <span class="va">N</span>,</span>
<span>  <span class="va">fu.min</span>,</span>
<span>  <span class="va">fu.max</span>,</span>
<span>  cens.prob <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  dist.x <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>  par.x <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  beta.x <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  dist.z <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  par.z <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">dist.rec</span>,</span>
<span>  <span class="va">par.rec</span>,</span>
<span>  pfree <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  dfree <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>N</dt>
<dd><p>Number of individuals</p></dd>


<dt>fu.min</dt>
<dd><p>Minimum length of follow-up.</p></dd>


<dt>fu.max</dt>
<dd><p>Maximum length of follow-up. Individuals length of follow-up is
generated from a uniform distribution on
 <code>[fu.min, fu.max]</code>. If <code>fu.min=fu.max</code>, then all individuals have a common
 follow-up.</p></dd>


<dt>cens.prob</dt>
<dd><p>Gives the probability of being censored due to loss to follow-up before
<code>fu.max</code>. For a random set of individuals defined by a B(N,<code>cens.prob</code>)-distribution,
the time to censoring is generated from a uniform
distribution on <code>[0, fu.max]</code>. Default is <code>cens.prob=0</code>, i.e. no censoring
due to loss to follow-up.</p></dd>


<dt>dist.x</dt>
<dd><p>Distribution of the covariate(s) \(X\). If there is more than one covariate,
<code>dist.x</code> must be a vector of distributions with one entry for each covariate. Possible
values are <code>"binomial"</code> and <code>"normal"</code>, default is <code>dist.x="binomial"</code>.</p></dd>


<dt>par.x</dt>
<dd><p>Parameters of the covariate distribution(s). For <code>"binomial", par.x</code> is
the probability for \(x=1\). For <code>"normal"</code>, <code>par.x=c(</code>\(\mu, \sigma\)<code>)</code>
where \(\mu\) is the mean and \(\sigma\) is the standard deviation of a normal distribution.
If one of the covariates is defined to be normally distributed, <code>par.x</code> must be a list,
e.g. <code> dist.x &lt;- c("binomial", "normal")</code> and <code>par.x  &lt;- list(0.5, c(1,2))</code>.
Default is <code>par.x=0</code>, i.e. \(x=0\) for all individuals.</p></dd>


<dt>beta.x</dt>
<dd><p>Regression coefficient(s) for the covariate(s) \(x\). If there is more than one
covariate, <code>beta.x</code> must be a vector of coefficients with one entry for each covariate.
<code>simrec</code> generates as many covariates as there are entries in <code>beta.x</code>. Default is
<code>beta.x=0</code>, corresponding to no effect of the covariate \(x\).</p></dd>


<dt>dist.z</dt>
<dd><p>Distribution of the frailty variable \(Z\) with \(E(Z)=1\) and
\(Var(Z)=\theta\). Possible values are <code>"gamma"</code> for a Gamma distributed frailty
 and <code>"lognormal"</code> for a lognormal distributed frailty.
 Default is <code>dist.z="gamma"</code>.</p></dd>


<dt>par.z</dt>
<dd><p>Parameter \(\theta\) for the frailty distribution: this parameter gives
the variance of the frailty variable \(Z\).
Default is <code>par.z=0</code>, which causes \(Z=1\), i.e. no frailty effect.</p></dd>


<dt>dist.rec</dt>
<dd><p>Form of the baseline hazard function. Possible values are <code>"weibull"</code> or
<code>"gompertz"</code> or <code>"lognormal"</code> or <code>"step"</code>.</p></dd>


<dt>par.rec</dt>
<dd><p>Parameters for the distribution of the event data.
If <code>dist.rec="weibull"</code> the  hazard function is $$\lambda_0(t)=\lambda*\nu* t^{\nu - 1},$$
where \(\lambda&gt;0\) is the scale and \(\nu&gt;0\) is the shape parameter. Then
<code>par.rec=c(</code>\(\lambda, \nu\)<code>)</code>. A special case
of this is the exponential distribution for \(\nu=1\).\
If <code>dist.rec="gompertz"</code>, the hazard function is $$\lambda_0(t)=\lambda*exp(\alpha t),$$
where \(\lambda&gt;0\) is the scale and \(\alpha\in(-\infty,+\infty)\) is the shape parameter.
Then <code>par.rec=c(</code>\(\lambda, \alpha\)<code>)</code>.\
If <code>dist.rec="lognormal"</code>, the hazard function is
$$\lambda_0(t)=[(1/(\sigma t))*\phi((ln(t)-\mu)/\sigma)]/[\Phi((-ln(t)-\mu)/\sigma)],$$
where \(\phi\) is the probability density function and \(\Phi\) is the cumulative
distribution function of the standard normal distribution, \(\mu\in(-\infty,+\infty)\) is a
location parameter and \(\sigma&gt;0\) is a shape parameter. Then <code>par.rec=c(</code>\(\mu,\sigma\)<code>)</code>.
Please note, that specifying <code>dist.rec="lognormal"</code> together with some covariates does not
specify the usual lognormal model (with covariates specified as effects on the parameters of the
lognormal distribution resulting in non-proportional hazards), but only defines the baseline
hazard and incorporates covariate effects using the proportional hazard assumption.\
If <code>dist.rec="step"</code> the hazard function is $$\lambda_0(t)=a, t&lt;=t_1, and \lambda_0(t)=b, t&gt;t_1$$.
Then <code>par.rec=c(</code>\(a,b,t_1\)<code>)</code>.</p></dd>


<dt>pfree</dt>
<dd><p>Probability that after experiencing an event the individual is not at risk
for experiencing further events for a length of <code>dfree</code> time units.
Default is <code>pfree=0</code>.</p></dd>


<dt>dfree</dt>
<dd><p>Length of the risk-free interval. Must be in the same time unit as <code>fu.max</code>.
Default is <code>dfree=0</code>, i.e. the individual is continously at risk for experiencing
events until end of follow-up.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The output is a data.frame consisting of the columns:</p>
<dl><dt>id</dt>
<dd><p>An integer number for identification of each individual</p></dd>

   <dt>x</dt>
<dd><p>or <code>x.V1, x.V2, ...</code> - depending on the covariate matrix. Contains the
      randomly generated value of the covariate(s) \(X\) for each individual.</p></dd>

   <dt>z</dt>
<dd><p>Contains the randomly generated value of the frailty variable \(Z\) for each individual.</p></dd>

   <dt>start</dt>
<dd><p>The start of interval <code>[start, stop]</code>, when the individual
      starts to be at risk for a next event.</p></dd>

   <dt>stop</dt>
<dd><p>The time of an event or censoring, i.e. the end of interval
   <code>[start, stop]</code>.</p></dd>

   <dt>status</dt>
<dd><p>An indicator of whether an event occured at time <code>stop</code> (<code>status=1</code>)
       or the individual is censored at time <code>stop</code> (<code>status=0</code>).</p></dd>

   <dt>fu</dt>
<dd><p>Length of follow-up period <code>[0,fu]</code> for each individual.</p></dd>

</dl><p>For each individual there are as many lines as it experiences events,
   plus one line if being censored.
   The data format corresponds to the counting process format.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Data are simulated by extending the methods proposed by Bender et al [2]
to the multiplicative intensity model.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ol><li><p>Andersen P, Gill R (1982): Cox's regression model for counting processes:
   a large sample study. The Annals of Statistics 10:1100-1120</p></li>
<li><p>Bender R, Augustin T, Blettner M (2005): Generating survival times to simulate Cox
  proportional hazards models. Statistics in Medicine 24:1713-1723</p></li>
<li><p>Jahn-Eimermacher A, Ingel K, Ozga AK, Preussler S, Binder H (2015): Simulating recurrent event data
  with hazard functions defined on a total time scale. BMC Medical Research Methodology 15:16</p></li>
</ol></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>simreccomp</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Katharina Ingel, Stella Preussler, Antje Jahn-Eimermacher.
Institute of Medical Biostatistics, Epidemiology and Informatics (IMBEI),
University Medical Center of the Johannes Gutenberg-University Mainz, Germany</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### Example:</span></span></span>
<span class="r-in"><span><span class="co">### A sample of 10 individuals</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### with a binomially distributed covariate with a regression coefficient</span></span></span>
<span class="r-in"><span><span class="co">### of beta=0.3, and a standard normally distributed covariate with a</span></span></span>
<span class="r-in"><span><span class="co">### regression coefficient of beta=0.2,</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dist.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"binomial"</span>, <span class="st">"normal"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">par.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### a gamma distributed frailty variable with variance 0.25</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dist.z</span> <span class="op">&lt;-</span> <span class="st">"gamma"</span></span></span>
<span class="r-in"><span><span class="va">par.z</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### and a Weibull-shaped baseline hazard with shape parameter lambda=1</span></span></span>
<span class="r-in"><span><span class="co">### and scale parameter nu=2.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dist.rec</span> <span class="op">&lt;-</span> <span class="st">"weibull"</span></span></span>
<span class="r-in"><span><span class="va">par.rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Subjects are to be followed for two years with 20% of the subjects</span></span></span>
<span class="r-in"><span><span class="co">### being censored according to a uniformly distributed censoring time</span></span></span>
<span class="r-in"><span><span class="co">### within [0,2] (in years).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fu.min</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">fu.max</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">cens.prob</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### After each event a subject is not at risk for experiencing further events</span></span></span>
<span class="r-in"><span><span class="co">### for a period of 30 days with a probability of 50%.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dfree</span> <span class="op">&lt;-</span> <span class="fl">30</span> <span class="op">/</span> <span class="fl">365</span></span></span>
<span class="r-in"><span><span class="va">pfree</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simdata</span> <span class="op">&lt;-</span> <span class="fu">simrec</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">N</span>, <span class="va">fu.min</span>, <span class="va">fu.max</span>, <span class="va">cens.prob</span>, <span class="va">dist.x</span>, <span class="va">par.x</span>, <span class="va">beta.x</span>, <span class="va">dist.z</span>, <span class="va">par.z</span>,</span></span>
<span class="r-in"><span>  <span class="va">dist.rec</span>, <span class="va">par.rec</span>, <span class="va">pfree</span>, <span class="va">dfree</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># print(simdata)  # only run for small N!</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Katharina Ingel, Antje Jahn-Eimermacher, Stella Preussler, <a href="https://federicomarini.github.io" class="external-link">Federico Marini</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

